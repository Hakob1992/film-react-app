(this["webpackJsonprehearsal-app"]=this["webpackJsonprehearsal-app"]||[]).push([[0],{29:function(e,t,a){},34:function(e,t,a){e.exports=a(73)},39:function(e,t,a){},65:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(31),r=a.n(c),o=a(33),s=(a(39),a(2)),u=a(5),i=a(1),m=a(10),E=a.n(m),d=new E.a({apiHost:"/"}),p=Object(n.createContext)();function b(e){var t=e.children,a=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(null),r=Object(i.a)(c,2),o=r[0],s=r[1],u=Object(n.useState)(null),m=Object(i.a)(u,2),E=m[0],p=m[1];return Object(n.useEffect)((function(){var e=window.localStorage.getItem("sid")||"";d.auth.isAuthorize(e,(function(e,t){!0===e&&(l(t.username),s(t.token),p(t.role))}))}),[]),{user:a,sessionID:o,login:function(e,t){return d.auth.login(e,t).then((function(e){l(e.username),s(e.sessionID),p(e.role),window.localStorage.setItem("sid",e.sessionID)}))},isAutorised:function(){return!!a},signout:function(e){return d.auth.logout("").then((function(t){l(null),p(null),s(null),window.localStorage.setItem("sid",null),e()}))},hasRole:function(e){if(!e)return!0;return E===e}}}();return l.a.createElement(p.Provider,{value:a},t)}var v=function(){return Object(n.useContext)(p)};a(65);function g(e){return l.a.createElement("div",{className:"loader-wrapper"},l.a.createElement("div",{className:"loader"}),l.a.createElement("span",{className:"loader-text"},e.text||"Loading..."))}a(29);function h(){var e=Object(s.g)(),t=v(),a=Object(n.useState)(!1),c=Object(i.a)(a,2),r=c[0],o=c[1];return Object(n.useEffect)((function(){o(!1)}),[t.user]),l.a.createElement(l.a.Fragment,null,t.user?l.a.createElement(l.a.Fragment,null,r?l.a.createElement(g,{text:"Logging out..."}):l.a.createElement(u.c,{onClick:function(){t.signout((function(){return e.push("/")})),o(!0)},className:"neonBtn",exact:!0,to:"/register"},l.a.createElement("span",null),l.a.createElement("span",null),l.a.createElement("span",null),l.a.createElement("span",null),"log out")):l.a.createElement(u.c,{className:"neonBtn ",exact:!0,to:"/login"},l.a.createElement("span",null),l.a.createElement("span",null),l.a.createElement("span",null),l.a.createElement("span",null),"Log in"))}function f(){var e=v();return l.a.createElement("ul",{className:"main-menu"},l.a.createElement("li",null,l.a.createElement("p",{className:"logo"},"MyMovies")),l.a.createElement("li",null,l.a.createElement(u.c,{className:"neon",exact:!0,to:"/"},"Watched")),l.a.createElement("li",null,l.a.createElement(u.c,{className:"neon",exact:!0,to:"/towatch"},"To Watch")),l.a.createElement("li",null,l.a.createElement(u.c,{className:"neon",exact:!0,to:"/add"},"Recomend movie")),l.a.createElement("li",{className:"rihgt-top"},!e.isAutorised()&&l.a.createElement(u.c,{className:"neonBtn",exact:!0,to:"/register"},l.a.createElement("span",null),l.a.createElement("span",null),l.a.createElement("span",null),l.a.createElement("span",null),"Register"),l.a.createElement(h,null)))}function O(){var e=Object(s.g)(),t=Object(s.h)(),a=Object(n.useState)(""),c=Object(i.a)(a,2),r=c[0],o=c[1],m=Object(n.useState)(""),E=Object(i.a)(m,2),d=E[0],p=E[1],b=Object(n.useState)(!1),h=Object(i.a)(b,2),f=h[0],O=h[1],j=Object(n.useState)(""),S=Object(i.a)(j,2),y=S[0],N=S[1],w=(t.state||{from:{pathname:"/"}}).from,C=v();Object(n.useEffect)((function(){C.isAutorised()&&e.replace(w)}));return l.a.createElement("div",{className:"content form"},"/add"===w.pathname?l.a.createElement("h2",null,"Please, log in to recommend a movie"):l.a.createElement("h1",null,"Log in"),l.a.createElement("form",{onSubmit:function(t){return t.preventDefault(),O(!0),C.login(r,d).then((function(){e.replace(w),O(!1)})).catch((function(e){N("You login or password is incorrect"),O(!1)})),!1}},l.a.createElement("input",{type:"text",placeholder:"login",onChange:function(e){o(e.target.value)}}),l.a.createElement("input",{type:"password",placeholder:"password",onChange:function(e){p(e.target.value)}}),y&&l.a.createElement("div",{className:"error"},y),f?l.a.createElement(g,{text:"Logging in..."}):l.a.createElement("div",null,l.a.createElement("button",null,"Log in"),l.a.createElement(u.b,{to:"register"},"Registration"))))}var j=a(3),S=new E.a({apiHost:"/"});function y(){var e=v(),t=Object(n.useState)(),a=Object(i.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(),s=Object(i.a)(o,2),u=(s[0],s[1]),m=Object(n.useState)(),E=Object(i.a)(m,2),d=E[0],p=E[1],b=Object(n.useState)(!1),h=Object(i.a)(b,2),f=h[0],O=h[1],y=Object(n.useState)(!0),N=Object(i.a)(y,2),w=N[0],C=N[1],_=Object(n.useState)({user_id:e.user}),M=Object(i.a)(_,2),x=M[0],I=M[1];return l.a.createElement("div",{className:"content"},l.a.createElement("h1",null,"Add Movie"),f&&l.a.createElement(g,null),w&&l.a.createElement("form",{onSubmit:function(){O(!0),C(!1),S.structure("movie_recomendation").setData("postMovie",x,{sessionID:e.sessionID}).then((function(e){r(e.result),u(e.status),O(!1)})).catch((function(e){O(!1),console.log(e.response),p({httpCode:e.response.status,msg:e.response.data.msg})}))}},l.a.createElement("input",{type:"text",placeholder:"Movie title",onChange:function(e){I(Object(j.a)(Object(j.a)({},x),{},{title:e.target.value}))}}),l.a.createElement("input",{type:"text",placeholder:"Year",onChange:function(e){I(Object(j.a)(Object(j.a)({},x),{},{year:e.target.value}))}}),l.a.createElement("input",{type:"text",placeholder:"Why do you recommend it?",onChange:function(e){I(Object(j.a)(Object(j.a)({},x),{},{description:e.target.value}))}}),l.a.createElement("button",{type:"submit"},"Submit")),c&&c[0].is_valid&&l.a.createElement("div",{className:"success"},l.a.createElement("b",null,"Submitted successfully"),l.a.createElement("p",null,"Thank you!")),d&&l.a.createElement("div",{class:"error"},l.a.createElement("b",null,d.httpCode," error"),"400"==d.httpCode&&l.a.createElement("p",null,"API-endpoint is not configured properly."),"403"==d.httpCode&&l.a.createElement("p",null,"You have to be logged in to submit this form."),l.a.createElement("p",null,l.a.createElement("code",null,d.msg))),c&&!c[0].is_valid&&l.a.createElement("div",{className:"error"},l.a.createElement("b",null,"Error"),l.a.createElement("p",null,c[0].error_msg)),!w&&!f&&l.a.createElement("button",{onClick:function(){r(),u(),p(),C(!0),I({user_id:e.user})}},"Submit one more movie"))}a(70),a(71);function N(e){return l.a.createElement("div",{className:"dropdown",onClick:e.onClick})}a(72);function w(e){var t=new E.a({apiHost:"/"}),a=v(),c=Object(n.useState)(),r=Object(i.a)(c,2),o=(r[0],r[1]),s=Object(n.useState)(),u=Object(i.a)(s,2),m=(u[0],u[1]),d=Object(n.useState)(),p=Object(i.a)(d,2),b=(p[0],p[1]),h=Object(n.useState)(!1),f=Object(i.a)(h,2),O=f[0],S=f[1],y=Object(n.useState)(!0),N=Object(i.a)(y,2),w=(N[0],N[1],Object(n.useState)({user_id:a.user})),C=Object(i.a)(w,2),_=C[0],M=C[1],x=Object(n.useState)(!1),I=Object(i.a)(x,2),k=I[0],D=I[1];function R(){S(!0),t.structure("movies").setData("rateMovies",Object(j.a)(Object(j.a)({},_),{},{is_watched:!0,id:e.movie.id}),{sessionID:a.sessionID}).then((function(t){o(t.result),m(t.status),S(!1),D(!0),e.handleReload()})).catch((function(e){S(!1),console.log(e.response),b({httpCode:e.response.status,msg:e.response.data.msg})}))}var A=Object(n.useState)(0),L=Object(i.a)(A,2),P=L[0],T=L[1];return l.a.createElement("div",{className:"modalWindow"},l.a.createElement("div",{className:"poster",style:{backgroundImage:"url(".concat(e.movie.poster,")")}}),l.a.createElement("div",{className:"movieInfo"},l.a.createElement("h2",null,e.movie.title),l.a.createElement("p",{className:"movieYear"},e.movie.year),l.a.createElement("p",{className:"imdbRating"},"IMDB: ",e.movie.imdb_ratings),l.a.createElement("p",null,l.a.createElement("span",null,"Director:")," ",e.movie.director," "),l.a.createElement("p",null,l.a.createElement("span",null,"Actors:")," ",e.movie.actors," "),l.a.createElement("p",null,l.a.createElement("span",null,"Plot:")," ",e.movie.plot," "),e.movie.my_rating&&l.a.createElement("div",{className:"stars"},l.a.createElement("div",null,"My rating:"),"1"==e.movie.my_rating&&l.a.createElement("span",null,"\u2b50"),"2"==e.movie.my_rating&&l.a.createElement("span",null,"\u2b50\u2b50"),"3"==e.movie.my_rating&&l.a.createElement("span",null,"\u2b50\u2b50\u2b50"),"4"==e.movie.my_rating&&l.a.createElement("span",null,"\u2b50\u2b50\u2b50\u2b50"),"5"==e.movie.my_rating&&l.a.createElement("span",null,"\u2b50\u2b50\u2b50\u2b50\u2b50")),O&&l.a.createElement(g,null),k&&l.a.createElement("p",{className:"hint"}," The movie has been rated!"),a.isAutorised()&&!a.hasRole("admin")&&!e.movie.is_watched&&l.a.createElement("p",{className:"hint"},"Only list owner can rate the movie"),!e.movie.is_watched&&!O&&!k&&a.hasRole("admin")&&l.a.createElement("div",{className:"rateThis"},l.a.createElement("p",null," ",0===P&&l.a.createElement("div",null,"Rate this movie:")),l.a.createElement("p",null," ",1===P&&l.a.createElement("div",null,"Awful!")),l.a.createElement("p",null," ",2===P&&l.a.createElement("div",null,"Bad")),l.a.createElement("p",null," ",3===P&&l.a.createElement("div",null,"Acceptable")),l.a.createElement("p",null," ",4===P&&l.a.createElement("div",null,"Good")),l.a.createElement("p",null," ",5===P&&l.a.createElement("div",null,"Wonderful!")),l.a.createElement("div",{className:"starsWrapper"},l.a.createElement("span",{className:"star ".concat(P>=1&&"active"),onMouseEnter:function(){T(1),M({my_rating:1})},onMouseLeave:function(){return T(0)},onClick:R},"\u2b50"),l.a.createElement("span",{className:"star ".concat(P>=2&&"active"),onMouseEnter:function(){T(2),M({my_rating:2})},onMouseLeave:function(){return T(0)},onClick:R},"\u2b50"),l.a.createElement("span",{className:"star ".concat(P>=3&&"active"),onMouseEnter:function(){T(3),M({my_rating:3})},onMouseLeave:function(){return T(0)},onClick:R},"\u2b50"),l.a.createElement("span",{className:"star ".concat(P>=4&&"active"),onMouseEnter:function(){T(4),M({my_rating:4})},onMouseLeave:function(){return T(0)},onClick:R},"\u2b50"),l.a.createElement("span",{className:"star ".concat(P>=5&&"active"),onMouseEnter:function(){T(5),M({my_rating:5})},onMouseLeave:function(){return T(0)},onClick:R},"\u2b50")))))}var C=new E.a({apiHost:"/"});function _(e){e.dataStructure,e.endpoint;var t=v(),a=Object(n.useState)([]),c=Object(i.a)(a,2),r=c[0],o=c[1],s=Object(n.useState)({}),u=Object(i.a)(s,2),m=u[0],E=u[1],d=Object(n.useState)(!0),p=Object(i.a)(d,2),b=p[0],h=p[1],f=Object(n.useState)(),O=Object(i.a)(f,2),j=O[0],S=O[1],y=Object(n.useState)(!1),_=Object(i.a)(y,2),M=_[0],x=_[1],I=Object(n.useState)(0),k=Object(i.a)(I,2),D=k[0],R=k[1],A=Object(n.useState)(e.pageSize||10),L=Object(i.a)(A,2),P=L[0],T=(L[1],Object(n.useState)()),W=Object(i.a)(T,2),z=W[0],B=W[1];Object(n.useEffect)((function(){x(!0),H()}),[D]);var Y=function(){H()};function H(){C.structure(e.dataStructure).getData(e.endpoint,{sessionID:t.sessionID,page:D,pageSize:P}).then((function(e){o(e.payload),E(e.pageInfo),h(!1),x(!1)})).catch((function(e){h(!1),x(!1),console.log(e.response),S(e.response.status+", "+e.response.data.msg)}))}return l.a.createElement(l.a.Fragment,null,b&&l.a.createElement(g,null),r&&!b&&l.a.createElement("div",null,l.a.createElement("div",{className:"moviesTable"},l.a.createElement("span",{className:"total"},"Movies:",m.tableSize," "),l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("td",null,"Poster"),l.a.createElement("td",null,"Title"),l.a.createElement("td",null,"Director"),l.a.createElement("td",null,"Actors"),l.a.createElement("td",null,"Rating"),l.a.createElement("td",null,"Who recomended"),e.watched&&l.a.createElement("td",null,"My rating"))),l.a.createElement("tbody",null,r.map((function(t){return l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("img",{src:t.poster,className:"smallImg"})),l.a.createElement("td",null,l.a.createElement("a",{onClick:function(){return B(t.id)}}," ",t.title)," (",t.year,")",z===t.id&&l.a.createElement("div",null,l.a.createElement(N,{onClick:function(){return B(null)}}),l.a.createElement(w,{movie:t,handleReload:Y}))),l.a.createElement("td",null,t.director),l.a.createElement("td",null,t.actors),l.a.createElement("td",null,t.imdb_ratings),l.a.createElement("td",null,t.user_id.name,t.recomendation&&': "'.concat(t.recomendation,' "')),e.watched&&l.a.createElement("td",null,"5"==t.my_rating&&"\u2b50\u2b50\u2b50\u2b50\u2b50","4"==t.my_rating&&"\u2b50\u2b50\u2b50\u2b50","3"==t.my_rating&&"\u2b50\u2b50\u2b50","2"==t.my_rating&&"\u2b50\u2b50","1"==t.my_rating&&"\u2b50"))}))))),M&&l.a.createElement(g,null),!M&&l.a.createElement("div",null,l.a.createElement("button",{className:D<=0&&"disabled",disabled:D<=0&&"disabled",onClick:function(){x(!0),R(D-1)}},"prev"),l.a.createElement("button",{className:(j||D>=m.totalPage-1)&&"disabled",disabled:(j||D>=m.totalPage-1)&&"disabled",onClick:function(){x(!0),R(D+1)}},"next"))))}function M(){return l.a.createElement("div",{className:"content"},l.a.createElement("h1",null,"Movies to watch"),l.a.createElement(_,{dataStructure:"movies",endpoint:"getMoviesToWatch",pageSize:10}))}function x(){return l.a.createElement("div",{className:"content"},l.a.createElement("h1",null,"Movies I have watched"),l.a.createElement(_,{watched:!0,dataStructure:"movies",endpoint:"getMoviesWatched",pageSize:10}))}var I=a(16),k=a.n(I),D=new E.a({apiHost:"/"});function R(){var e=v(),t=Object(n.useState)(),a=Object(i.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(),s=Object(i.a)(o,2),m=(s[0],s[1]),E=Object(n.useState)(),d=Object(i.a)(E,2),p=d[0],b=d[1],h=Object(n.useState)(!1),f=Object(i.a)(h,2),O=f[0],S=f[1],y=Object(n.useState)(!0),N=Object(i.a)(y,2),w=N[0],C=N[1],_=Object(n.useState)({}),M=Object(i.a)(_,2),x=M[0],I=M[1];return l.a.createElement("div",{className:"content"},l.a.createElement("h1",null,"Register"),O&&l.a.createElement(g,null),w&&l.a.createElement("form",{onSubmit:function(){S(!0),C(!1),D.structure("reg_requests").setData("register",x,{sessionID:e.sessionID}).then((function(e){r(e.result),m(e.status),S(!1)})).catch((function(e){S(!1),console.log(e.response),b({httpCode:e.response.status,msg:e.response.data.msg})}))}},l.a.createElement("input",{type:"text",value:x.email,placeholder:"Your email",onChange:function(e){I(Object(j.a)(Object(j.a)({},x),{},{email:e.target.value}))}}),l.a.createElement("p",{className:"tip"},"This will be your login "),l.a.createElement("input",{type:"text",value:x.name,placeholder:"Name",onChange:function(e){I(Object(j.a)(Object(j.a)({},x),{},{name:e.target.value}))}}),l.a.createElement("input",{type:"text",value:x.twitter,placeholder:"Twitter account",onChange:function(e){I(Object(j.a)(Object(j.a)({},x),{},{twitter:e.target.value}))}}),l.a.createElement("input",{type:"password",placeholder:"Password",onChange:function(e){I(Object(j.a)(Object(j.a)({},x),{},{pass:k()(e.target.value)}))}}),l.a.createElement("input",{type:"password",placeholder:"Repeat password",onChange:function(e){I(Object(j.a)(Object(j.a)({},x),{},{re_pass:k()(e.target.value)}))}}),l.a.createElement("button",{type:"submit"},"Submit")),c&&c[0].is_valid&&l.a.createElement("div",null,l.a.createElement("b",null,"Sign up successfully"),l.a.createElement(u.b,{to:"/login"},l.a.createElement("button",null,"Login"))),c&&!c[0].is_valid&&l.a.createElement("div",{className:"error"},l.a.createElement("b",null,"Error"),l.a.createElement("p",null,c[0].error)),p&&l.a.createElement("div",{class:"error"},l.a.createElement("b",null,p.httpCode," error"),"400"==p.httpCode&&l.a.createElement("p",null,"API-endpoint is not configured properly."),"403"==p.httpCode&&l.a.createElement("p",null,"You have to be logged in to submit this form."),l.a.createElement("p",null,l.a.createElement("code",null,p.msg))),!w&&!O&&l.a.createElement("button",{onClick:function(){r(),m(),b(),C(!0)}},"Edit my data"))}function A(e){var t=e.children,a=e.hasRole,n=Object(o.a)(e,["children","hasRole"]),c=v();return l.a.createElement(s.b,Object.assign({},n,{render:function(e){var n=e.location;return c.isAutorised()&&c.hasRole(a)?t:c.isAutorised()&&!c.hasRole(a)?l.a.createElement("div",null,"Access denied"):l.a.createElement(s.a,{to:{pathname:"/login",state:{from:n}}})}}))}function L(){return l.a.createElement(b,null,l.a.createElement(u.a,null,l.a.createElement(f,null),l.a.createElement(s.d,null,l.a.createElement(s.b,{path:"/login"},l.a.createElement(O,null)),l.a.createElement(s.b,{exact:!0,path:"/"},l.a.createElement(x,null)),l.a.createElement(s.b,{exact:!0,path:"/towatch"},l.a.createElement(M,null)),l.a.createElement(s.b,{exact:!0,path:"/register"},l.a.createElement(R,null)),l.a.createElement(A,{path:"/add"},l.a.createElement(y,null)))))}r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(L,null)),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.8a795c11.chunk.js.map